
<h1>Documentos</h1>
<div style='float:right;margin-top:-20px;'>
	<button  type="button" class="btn btn-info" id="btnSubir"><i class="icon-upload icon-white"></i> Subir Documento</button>
	
</div>
<span>Busqueda </span><br>
<form id="myform" action="index.php?id=registro&seccion=investigaciones" method="post">
<input  id="busqueda" name="busqueda" placeholder="Busqueda de investigaciones" value="{tpl-busqueda}"/>
 <button id="buscar" style="width:80px;">Buscar</button>
 <div id="resultado_busqueda">
 {tpl-datos}
 </div>
 </form>


 <script type="text/javascript">
	<!--
		var operaciones_ajax="operaciones.php";
	$(document).ready(function(){

		$("#buscar").click(function() {			
			
			$("#myform").submit();
			});
				       
        $("#btnSubir").click(function() {
        	MTD_MOSTRAR_FORMULARIO_DOCUMENTOS();
			});		
	});					 
	function MTD_MOSTRAR_FORMULARIO_DOCUMENTOS()
	{
		var codigo ="";
	    var mensaje_error="";    

	    
	    // Load dialog on click	
	    //$('#basic-modal-content').modal();
		var parametros 	= {operacion: "mostrar_abm_documentos"};	
		$.ajax({
	        url: operaciones_ajax,data: parametros,type: "POST",cache: false,async: true,
	        success: function(data) 
	        {
	        	$("#basic-modal-content").empty();
	        	$("#basic-modal-content").append(data);
	        	$('#basic-modal-content').modal();    	
	        	
	         }
	    });
	   
	  	
	}
	function MTD_EDITAR_DOCUMENTO(id_documento)
	{
		var codigo ="";
	    var mensaje_error="";    

	    
	    // Load dialog on click	
	    //$('#basic-modal-content').modal();
		var parametros 	= {operacion: "editar_documentos", id_documento: id_documento};	
		$.ajax({
	        url: operaciones_ajax,data: parametros,type: "POST",cache: false,async: true,
	        success: function(data) 
	        {
	        	$("#basic-modal-content").empty();
	        	$("#basic-modal-content").append(data);
	        	$('#basic-modal-content').modal();    	
	        	
	         }
	    });
	   
	  	
	}
	function MTD_AGREGAR_DOCUMENTO()
	{

		var codigo ="";
	    var mensaje_error="";    
	    var titulo="";
	    var descripcion="";
	    var etiquetas="";
	    var categoria="";
	    titulo=$("#titulo").val();
	    etiquetas=$("#etiquetas").val();
	    descripcion=$("#descripcion").val();
	    categoria = $("#lst_categorias :selected").val();
	    	//Load dialog on click	
	        //$('#basic-modal-content').modal();
	    	var parametros 	= {operacion: "ingresar_documento", titulo: titulo, descripcion: descripcion, etiquetas: etiquetas,categoria: categoria};
	     
	        // Load dialog on click	
	        //$('#basic-modal-content').modal();
	   if (titulo !=""   && descripcion != "" )
	   {
	    	$.ajax({
	            url: operaciones_ajax,data: parametros,type: "POST",cache: false,async: true,
	            success: function(data) 
	            {
	            	if (data == "1")
	            	{
	            		$("#contenedor_resultado").empty();
	               	 	$("#contenedor_resultado").append("<br><br><h3>Documentacion creada exitosamente </h3>");	
	            	}
	            	else
	            	{
	            		alert(data);
	            	}
	             }
	        });
	   }
	   else
	   {
	   		alert("Atencion,<br> Debera ingresar un titulo, una descripcion y un autor");		   
	   }
	   
	}	 
	function MTD_ACTUALIZAR_DOCUMENTO()
	{

		
	    var mensaje_error="";    
	    var id_documento ="";
	    var titulo="";
	    var descripcion="";
	    var etiquetas="";
	    var categoria="";
	    id_documento=$("#id_documento").val();
	    titulo=$("#titulo").val();
	    etiquetas=$("#etiquetas").val();
	    descripcion=$("#descripcion").val();
	    categoria = $("#lst_categorias :selected").val();
	    	//Load dialog on click	
	        //$('#basic-modal-content').modal();
	    	var parametros 	= {operacion: "actualizar_documento",id_documento: id_documento, titulo: titulo, descripcion: descripcion, etiquetas: etiquetas,categoria: categoria};
	     
	        // Load dialog on click	
	        //$('#basic-modal-content').modal();
	   if (titulo !=""   && descripcion != "" )
	   {
	    	$.ajax({
	            url: operaciones_ajax,data: parametros,type: "POST",cache: false,async: true,
	            success: function(data) 
	            {
	            	if (data == "1")
	            	{
	            		$("#contenedor_resultado").empty();
	               	 	$("#contenedor_resultado").append("<br><br><h3>Documentacion actualizada exitosamente </h3>");	
	            	}
	            	else
	            	{
	            		alert(data);
	            	}
	             }
	        });
	   }
	   else
	   {
	   		alert("Atencion,<br> Debera ingresar un titulo, una descripcion y un autor");		   
	   }
	   
	}	   
	function MTD_ELIMINAR_DOCUMENTO(vp_id_documento)
	{
		var descripcion ="";
	    var mensaje_error="";    

	    descripcion     		=$("#descripcion").val();
	    // Load dialog on click	
	    //$('#basic-modal-content').modal();
	    var conf = confirm("Esta seguro de eliminar el documento #" + vp_id_documento);

	    if(conf == true)
	    {

			    var parametros 	= {operacion: "eliminar_documento", id_documento: vp_id_documento};	
				$.ajax({
			        url: operaciones_ajax,data: parametros,type: "POST",cache: false,async: true,
			        success: function(data) 
			        {
			        	
			        	if (data == "0")
		                    {
		                    	//location.href="index.php?id=registro&seccion=consultorio";
		                        //ENVIAR AL FORMULARIO DE LOGIN
		                        //TODO ACTUALIZAR GRILLA
		                        //MTD_LISTAR_CATEGORIA();
		                        alert("Documento Eliminado");
		                    }
		                    else 
		                    {
		                    	
		                    }
			         }
			    });	  

	    }

		  	   	
	}		
//-->
</script>
<div id ="basic-modal-content">&nbsp;</div>
<div id ="contenedor-resultado">&nbsp;</div>